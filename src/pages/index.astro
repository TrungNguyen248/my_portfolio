---
import Layout from '../layouts/Layout.astro';

const skills = [
	"JavaScript (ES6+)", "Golang", "PHP", 
	"React.js", "Next.js", 
	"Node.js (Express)", "Gin", 
	"MySQL", "PostgreSQL", "MongoDB", "Redis", 
	"Docker", "Git", "Linux"
];

const skillCategories = [
	{ name: "Programming Languages", items: ["JavaScript", "Golang", "PHP"] },
	{ name: "Frontend", items: ["React.js", "Next.js"] },
	{ name: "Backend", items: ["Node.js (Express.js)", "Golang (Gin)"] },
	{ name: "Databases", items: ["MySQL", "PostgreSQL", "MongoDB", "Redis"] },
	{ name: "DevOps & Tools", items: ["Docker", "Git", "Linux"] }
];

// D·ªÆ LI·ªÜU PROJECT ƒê∆Ø·ª¢C THI·∫æT K·∫æ LINH HO·∫†T H∆†N
const projects = [
	{ 
		id: "p1", name: "e-commerce-api", type: "dir", size: "4.0K", 
		desc: { en: "RESTful API with Node.js & MongoDB", vi: "RESTful API b·∫±ng Node.js & MongoDB" },
		details: {
			tech: ["Node.js", "Express", "MongoDB", "JWT"],
			images: [
				"https://images.unsplash.com/photo-1555066931-4365d14bab8c?q=80&w=800"
			],
			links: [
				{ label: "GitHub Repo", url: "https://github.com/TrungNguyen248/ecommerce-api" },
				{ label: "API Documentation", url: "https://api.example.com/docs" }
			],
			about: { 
				en: "A complete backend service for an e-commerce platform featuring user authentication, product management, and order processing.", 
				vi: "H·ªá th·ªëng backend ho√†n ch·ªânh cho s√†n th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ v·ªõi t√≠nh nƒÉng x√°c th·ª±c, qu·∫£n l√Ω s·∫£n ph·∫©m v√† x·ª≠ l√Ω ƒë∆°n h√†ng." 
			}
		}
	},
	{ 
		id: "p2", name: "golang-microservices", type: "dir", size: "2.1K", 
		desc: { en: "High-performance microservices with Go & Gin", vi: "Microservices hi·ªáu nƒÉng cao v·ªõi Golang & Gin" },
		details: {
			tech: ["Golang", "Gin", "Redis", "Docker", "gRPC"],
			images: [
				"https://images.unsplash.com/photo-1498050108023-c5249f4df085?q=80&w=800",
				"https://images.unsplash.com/photo-1526374965328-7f61d4dc18c5?q=80&w=800" // C√≥ th·ªÉ c√≥ 2 ·∫£nh
			],
			links: [
				{ label: "Source Code", url: "https://github.com/TrungNguyen248/go-microservices" }
			],
			about: { 
				en: "Highly scalable microservices architecture built with Golang and gRPC for fast inter-service communication.", 
				vi: "Ki·∫øn tr√∫c microservices c√≥ kh·∫£ nƒÉng m·ªü r·ªông cao, s·ª≠ d·ª•ng Golang v√† gRPC ƒë·ªÉ giao ti·∫øp n·ªôi b·ªô si√™u t·ªëc." 
			}
		}
	},
	{ 
		id: "p3", name: "nextjs-dashboard", type: "dir", size: "12M", 
		desc: { en: "Admin Dashboard with Next.js & React", vi: "Trang qu·∫£n tr·ªã Admin v·ªõi Next.js" },
		details: {
			tech: ["Next.js", "React.js", "TailwindCSS", "PostgreSQL"],
			images: [
				"https://images.unsplash.com/photo-1461749280684-dccba630e2f6?q=80&w=800"
			],
			links: [
				{ label: "Live Demo", url: "https://dashboard.trungnguyen.local" },
				{ label: "GitHub", url: "https://github.com/TrungNguyen248/nextjs-admin" }
			],
			about: { 
				en: "A modern administrative dashboard providing real-time data visualization and content management features.", 
				vi: "B·∫£ng ƒëi·ªÅu khi·ªÉn qu·∫£n tr·ªã hi·ªán ƒë·∫°i cung c·∫•p bi·ªÉu ƒë·ªì d·ªØ li·ªáu th·ªùi gian th·ª±c v√† qu·∫£n l√Ω n·ªôi dung." 
			}
		}
	}
];

const defaultWallpaper = "https://i.pinimg.com/736x/a7/fb/88/a7fb880a4c5acfdefb2703d8559adf00.jpg";
---

<Layout title="Nguy·ªÖn Trung Nguy√™n | Ubuntu OS Portfolio">
	
	<div id="boot-screen" class="fixed inset-0 z-[99999] bg-[#2c001e] flex flex-col items-center justify-center transition-opacity duration-1000 ease-in-out">
		<svg width="128px" height="128px" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M30 16C30 23.728 23.735 30 16 30C8.265 30 2 23.728 2 16C2 8.265 8.265 2 16 2C23.735 2 30 8.265 30 16Z" fill="#E95420"></path> <path d="M6.82154 14.1563C5.81185 14.1563 5 14.9865 5 16.0035C5 17.0205 5.81867 17.8507 6.82154 17.8507C7.82442 17.8507 8.64309 17.0205 8.64309 16.0035C8.64309 14.9795 7.82442 14.1563 6.82154 14.1563ZM19.8316 22.5482C18.9583 23.0602 18.665 24.1879 19.163 25.0734C19.6679 25.959 20.7799 26.2634 21.6531 25.7514C22.5264 25.2395 22.8197 24.1118 22.3217 23.2262C21.8101 22.3476 20.698 22.0432 19.8316 22.5482ZM10.7785 16.0035C10.7785 14.177 11.6722 12.565 13.0434 11.5896L11.7131 9.32725C10.1167 10.4065 8.93645 12.06 8.43842 13.9902C9.01149 14.4676 9.37989 15.194 9.37989 16.0035C9.37989 16.8129 9.01149 17.5393 8.43842 18.0167C8.92962 19.9469 10.1167 21.6004 11.7131 22.6797L13.0434 20.4174C11.6722 19.4419 10.7785 17.8299 10.7785 16.0035ZM16.0998 10.6071C18.8833 10.6071 21.1619 12.7657 21.4007 15.5261L24 15.4846C23.8704 13.4506 22.9971 11.6241 21.6463 10.282C20.9504 10.5449 20.1522 10.5034 19.4632 10.1021C18.7673 9.69393 18.3375 9.01593 18.2147 8.26875C17.5393 8.08195 16.8298 7.97817 16.0998 7.97817C14.8377 7.97817 13.6506 8.27566 12.5932 8.80838L13.8621 11.1053C14.5375 10.787 15.3016 10.6071 16.0998 10.6071ZM16.0998 21.3998C15.3016 21.3998 14.5375 21.2199 13.8553 20.9017L12.5864 23.1985C13.6438 23.7313 14.8377 24.0287 16.093 24.0287C16.823 24.0287 17.5325 23.925 18.2079 23.7382C18.3239 22.9979 18.7605 22.313 19.4564 21.9048C20.1454 21.4966 20.9504 21.462 21.6395 21.7249C22.9835 20.3828 23.8636 18.5563 23.9932 16.5223L21.3939 16.4808C21.1619 19.2343 18.8833 21.3998 16.0998 21.3998ZM19.8248 9.45178C20.698 9.96374 21.8101 9.65933 22.3149 8.77378C22.8197 7.88824 22.5196 6.76054 21.6463 6.24859C20.7731 5.73663 19.661 6.04104 19.1562 6.92659C18.6582 7.81213 18.9583 8.93983 19.8248 9.45178Z" fill="white"></path> </g></svg>
		<div class="w-8 h-8 border-4 border-[#E95420] border-t-transparent rounded-full animate-spin"></div>
		<p class="mt-4 text-white font-bold text-xl tracking-widest">UBANTU</p>
	</div>

	<div id="desktop" class="absolute inset-0 bg-cover bg-center bg-no-repeat opacity-0 transition-all duration-1000 flex flex-col overflow-hidden" style={`background-image: url('${defaultWallpaper}')`}>
		
		<div class="h-7 bg-black/70 backdrop-blur-md text-white flex justify-between items-center px-4 text-sm z-[10000] select-none shadow-md border-b border-white/10">
			<div class="flex items-center gap-4 cursor-pointer hover:bg-white/20 px-2 h-full transition-colors rounded-sm" id="btn-activities">
				<span class="font-bold">Activities</span>
			</div>
			<div class="flex-1 text-center font-medium" id="clock">Jan 01 12:00</div>
			<div class="flex items-center gap-4">
				<span class="text-xs font-bold uppercase" id="topbar-lang-indicator">EN</span>
				<button id="btn-power" class="hover:text-[#dd4814] transition-colors" title="Restart System">
					<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 2a1 1 0 00-1 1v1a1 1 0 102 0V3a1 1 0 00-1-1zM4 6a2 2 0 012-2h8a2 2 0 012 2v2h2a1 1 0 110 2h-2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2H2a1 1 0 110-2h2V6z" clip-rule="evenodd"></path></svg>
				</button>
			</div>
		</div>

		<div class="flex-1 relative w-full h-full flex">
			
			<div class="w-16 h-full bg-black/40 border-r border-white/10 flex flex-col items-center py-4 gap-4 z-[9000] shadow-2xl backdrop-blur-md">
				<button class="dock-btn group relative flex justify-center items-center w-12 h-12 rounded-lg hover:bg-white/20 transition-colors" data-app="terminal" id="dock-terminal">
					<div class="w-10 h-10 bg-[#300a24] rounded-lg border border-gray-600 flex items-center justify-center shadow-lg">
						<span class="text-white font-mono text-sm font-bold">$_</span>
					</div>
					<div class="app-dot absolute left-0 top-1/2 -translate-y-1/2 w-1 h-1 bg-[#E95420] rounded-full hidden shadow-[0_0_5px_#E95420]"></div>
					<span class="tooltip hidden group-hover:block absolute left-14 bg-black/80 text-white text-xs px-2 py-1 rounded whitespace-nowrap z-50">Terminal</span>
				</button>

				<button class="dock-btn group relative flex justify-center items-center w-12 h-12 rounded-lg hover:bg-white/20 transition-colors" data-app="files" id="dock-files">
					<svg class="w-10 h-10 text-orange-400 drop-shadow-md" viewBox="0 0 24 24" fill="currentColor"><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/></svg>
					<div class="app-dot absolute left-0 top-1/2 -translate-y-1/2 w-1 h-1 bg-[#E95420] rounded-full hidden shadow-[0_0_5px_#E95420]"></div>
					<span class="tooltip hidden group-hover:block absolute left-14 bg-black/80 text-white text-xs px-2 py-1 rounded whitespace-nowrap z-50"><span class="lang-en">Files</span><span class="lang-vi">T·∫≠p tin</span></span>
				</button>

				<button class="dock-btn group relative flex justify-center items-center w-12 h-12 rounded-lg hover:bg-white/20 transition-colors" data-app="settings" id="dock-settings">
					<div class="w-10 h-10 bg-gray-200 rounded-lg flex items-center justify-center shadow-lg">
						<svg class="w-7 h-7 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
					</div>
					<div class="app-dot absolute left-0 top-1/2 -translate-y-1/2 w-1 h-1 bg-[#E95420] rounded-full hidden shadow-[0_0_5px_#E95420]"></div>
					<span class="tooltip hidden group-hover:block absolute left-14 bg-black/80 text-white text-xs px-2 py-1 rounded whitespace-nowrap z-50"><span class="lang-en">Settings</span><span class="lang-vi">C√†i ƒë·∫∑t</span></span>
				</button>
			</div>

			<div class="flex-1 relative overflow-hidden" id="window-area">
				
				<div id="activities-backdrop" class="absolute inset-0 bg-black/70 backdrop-blur-sm z-[4999] hidden transition-opacity"></div>

				<div class="absolute right-6 top-6 w-64 bg-[#fbf0b9] text-gray-800 p-5 shadow-[5px_5px_15px_rgba(0,0,0,0.3)] transform rotate-2 z-[10] rounded-sm border border-yellow-200 pointer-events-none">
					<div class="absolute -top-3 left-1/2 -translate-x-1/2 w-16 h-6 bg-white/40 rotate-[-2deg] shadow-sm"></div>
					<h3 class="font-bold text-lg mb-2 border-b border-gray-300 pb-1 font-ubuntu-mono">üìå Commands</h3>
					<ul class="text-sm font-ubuntu-mono space-y-2">
						<li><span class="text-blue-700 font-bold">whoami</span>  : <span class="lang-en">Profile</span><span class="lang-vi">H·ªì s∆°</span></li>
						<li><span class="text-blue-700 font-bold">skill</span>   : <span class="lang-en">My Skills</span><span class="lang-vi">K·ªπ nƒÉng</span></li>
						<li><span class="text-blue-700 font-bold">projects</span>: <span class="lang-en">My works</span><span class="lang-vi">D·ª± √°n</span></li>
						<li><span class="text-blue-700 font-bold">contact</span> : <span class="lang-en">Ping me</span><span class="lang-vi">Li√™n h·ªá</span></li>
						<li><span class="text-blue-700 font-bold">help</span>    : <span class="lang-en">Commands</span><span class="lang-vi">Tr·ª£ gi√∫p</span></li>
						<li><span class="text-red-600 font-bold">clear</span>   : <span class="lang-en">Clean up</span><span class="lang-vi">D·ªçn d·∫πp</span></li>
					</ul>
				</div>

				<div id="win-terminal" class="app-window absolute hidden flex-col rounded-lg shadow-[0_25px_50px_rgba(0,0,0,0.7)] border border-gray-700 bg-[#300a24]/95 backdrop-blur-md overflow-hidden" style="width: 900px; max-width: 95vw; height: 750px; top: 8%; left: 10%;">
					<div class="window-header h-10 bg-[#2d2d2d] flex justify-between items-center px-4 select-none cursor-move border-b border-black">
						<div class="text-gray-300 text-sm font-bold tracking-wide">nguyen@ubuntu:~</div>
						<div class="flex items-center gap-3">
							<button id="btn-auto" class="mr-2 text-xs bg-[#dd4814] hover:bg-[#ff5f2e] text-white px-2 py-1 rounded shadow font-bold z-50 cursor-pointer">‚ñ∂ Auto Run</button>
							<button class="win-btn-minimize w-4 h-4 flex items-center justify-center text-gray-400 hover:text-white bg-transparent hover:bg-gray-600 rounded-full z-50 cursor-pointer"><svg class="w-3 h-3 pointer-events-none" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button>
							<button class="win-btn-maximize w-4 h-4 flex items-center justify-center text-gray-400 hover:text-white bg-transparent hover:bg-gray-600 rounded-full z-50 cursor-pointer"><svg class="w-3 h-3 border border-current rounded-sm pointer-events-none" viewBox="0 0 10 10"></svg></button>
							<button class="win-btn-close w-4 h-4 flex items-center justify-center text-gray-400 hover:text-white bg-transparent hover:bg-[#E95420] rounded-full z-50 cursor-pointer"><svg class="w-3 h-3 pointer-events-none" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
						</div>
					</div>
					<div class="flex-1 flex overflow-hidden cursor-text" id="terminal-body">
						<div class="w-32 hidden sm:block border-r border-gray-700/50 p-4 overflow-y-auto custom-scrollbar relative pointer-events-none">
							<div class="absolute right-0 top-0 bottom-0 w-[1px] bg-gray-600"></div>
							<ul id="timeline-list" class="relative flex flex-col items-end pr-[3px] mt-2 gap-4 pointer-events-auto"></ul>
						</div>
						<div id="main-terminal-scroll" class="flex-1 p-4 md:p-6 overflow-y-auto scroll-smooth font-ubuntu-mono text-base text-gray-200 custom-scrollbar relative flex flex-col">
							<div class="mb-6 text-gray-400 text-sm">
								<span class="lang-en">Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.15.0-101-generic x86_64)<br>System is ready. Type <span class="text-white font-bold">help</span> to start.</span>
								<span class="lang-vi">Ch√†o m·ª´ng t·ªõi Ubuntu 22.04.4 LTS (GNU/Linux 5.15.0-101-generic x86_64)<br>H·ªá th·ªëng ƒë√£ s·∫µn s√†ng. G√µ <span class="text-white font-bold">help</span> ƒë·ªÉ b·∫Øt ƒë·∫ßu.</span>
							</div>
							<div id="history-container" class="flex flex-col gap-3"></div>
							<div id="input-line" class="flex items-center mt-3 pb-4">
								<span class="text-[#8ae234] font-bold shrink-0">nguyen@ubuntu</span><span class="text-white shrink-0 mx-1">:</span><span class="text-[#729fcf] font-bold shrink-0">~</span><span class="text-white font-bold ml-1 shrink-0">$</span>
								<input type="text" id="cmd-input" autocomplete="off" spellcheck="false" class="ml-2 flex-1 bg-transparent border-none outline-none text-white caret-white focus:ring-0 p-0 m-0 font-ubuntu-mono" />
							</div>
						</div>
					</div>
				</div>

				<div id="win-files" class="app-window absolute hidden flex-col rounded-lg shadow-[0_25px_50px_rgba(0,0,0,0.5)] border border-gray-300 dark:border-gray-700 bg-gray-100 dark:bg-[#1e1e1e] overflow-hidden" style="width: 750px; height: 500px; top: 15%; left: 20%;">
					<div class="window-header h-12 bg-gray-200 dark:bg-[#2d2d2d] flex justify-between items-center px-4 select-none cursor-move border-b border-gray-300 dark:border-black">
						<div class="flex items-center gap-2 font-bold text-gray-800 dark:text-gray-200">
							<svg class="w-5 h-5 text-orange-500" viewBox="0 0 24 24" fill="currentColor"><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/></svg>
							<span>Projects <span class="font-normal text-sm text-gray-500">~ /home/nguyen/projects</span></span>
						</div>
						<div class="flex items-center gap-3">
							<button class="win-btn-minimize w-4 h-4 flex items-center justify-center text-gray-500 hover:text-black dark:text-gray-400 dark:hover:text-white bg-transparent hover:bg-gray-300 dark:hover:bg-gray-600 rounded-full z-50 cursor-pointer"><svg class="w-3 h-3 pointer-events-none" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button>
							<button class="win-btn-maximize w-4 h-4 flex items-center justify-center text-gray-500 hover:text-black dark:text-gray-400 dark:hover:text-white bg-transparent hover:bg-gray-300 dark:hover:bg-gray-600 rounded-full z-50 cursor-pointer"><svg class="w-3 h-3 border border-current rounded-sm pointer-events-none" viewBox="0 0 10 10"></svg></button>
							<button class="win-btn-close w-4 h-4 flex items-center justify-center text-gray-500 hover:text-black dark:text-gray-400 dark:hover:text-white bg-transparent hover:bg-[#E95420] rounded-full z-50 cursor-pointer"><svg class="w-3 h-3 pointer-events-none" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
						</div>
					</div>
					<div class="flex-1 p-6 overflow-y-auto custom-scrollbar flex content-start flex-wrap gap-6 text-gray-800 dark:text-gray-200">
						{projects.map(p => (
							<div class="project-link flex flex-col items-center w-28 p-2 rounded hover:bg-black/10 dark:hover:bg-white/10 transition-colors cursor-pointer group" data-id={p.id}>
								{p.type === 'dir' ? (
									<svg class="w-16 h-16 text-orange-400 drop-shadow group-hover:scale-105 transition-transform" viewBox="0 0 24 24" fill="currentColor"><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/></svg>
								) : (
									<svg class="w-16 h-16 text-gray-400 drop-shadow group-hover:scale-105 transition-transform" viewBox="0 0 24 24" fill="currentColor"><path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/></svg>
								)}
								<span class="text-sm font-medium text-center truncate w-full mt-1 group-hover:text-blue-600 dark:group-hover:text-blue-400">{p.name}</span>
								<span class="text-[10px] text-gray-500 line-clamp-1"><span class="lang-en">{p.desc.en}</span><span class="lang-vi">{p.desc.vi}</span></span>
							</div>
						))}
					</div>
				</div>

				<div id="win-settings" class="app-window absolute hidden flex-col rounded-lg shadow-[0_25px_50px_rgba(0,0,0,0.5)] border border-gray-300 dark:border-gray-700 bg-white dark:bg-[#1e1e1e] overflow-hidden" style="width: 550px; height: 450px; top: 18%; left: 30%;">
					<div class="window-header h-12 bg-gray-100 dark:bg-[#2d2d2d] flex justify-between items-center px-4 select-none cursor-move border-b border-gray-300 dark:border-black">
						<div class="font-bold text-gray-800 dark:text-gray-200 flex items-center gap-2">
							<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
							<span class="lang-en">Settings</span><span class="lang-vi">C√†i ƒë·∫∑t</span>
						</div>
						<div class="flex items-center gap-3">
							<button class="win-btn-minimize w-4 h-4 flex items-center justify-center text-gray-500 hover:text-black dark:text-gray-400 dark:hover:text-white bg-transparent hover:bg-gray-300 dark:hover:bg-gray-600 rounded-full z-50 cursor-pointer"><svg class="w-3 h-3 pointer-events-none" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button>
							<button class="win-btn-maximize w-4 h-4 flex items-center justify-center text-gray-500 hover:text-black dark:text-gray-400 dark:hover:text-white bg-transparent hover:bg-gray-300 dark:hover:bg-gray-600 rounded-full z-50 cursor-pointer"><svg class="w-3 h-3 border border-current rounded-sm pointer-events-none" viewBox="0 0 10 10"></svg></button>
							<button class="win-btn-close w-4 h-4 flex items-center justify-center text-gray-500 hover:text-black dark:text-gray-400 dark:hover:text-white bg-transparent hover:bg-[#E95420] rounded-full z-50 cursor-pointer"><svg class="w-3 h-3 pointer-events-none" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
						</div>
					</div>
					<div class="flex-1 p-6 text-gray-800 dark:text-gray-200 space-y-6 overflow-y-auto custom-scrollbar">
						<div>
							<div class="font-bold text-lg"><span class="lang-en">Wallpaper</span><span class="lang-vi">H√¨nh n·ªÅn</span></div>
							<div class="text-sm text-gray-500 mb-3"><span class="lang-en">Select desktop background</span><span class="lang-vi">Ch·ªçn ·∫£nh n·ªÅn m√°y t√≠nh</span></div>
							<div class="flex gap-3">
								<button class="wp-btn w-16 h-12 rounded bg-cover bg-center border-2 border-transparent hover:border-[#dd4814] focus:border-[#dd4814] transition-all" style="background-image: url('https://i.pinimg.com/736x/a7/fb/88/a7fb880a4c5acfdefb2703d8559adf00.jpg')" data-url="https://i.pinimg.com/736x/a7/fb/88/a7fb880a4c5acfdefb2703d8559adf00.jpg"></button>
								<button class="wp-btn w-16 h-12 rounded bg-cover bg-center border-2 border-transparent hover:border-[#dd4814] focus:border-[#dd4814] transition-all" style="background-image: url('https://i.pinimg.com/736x/f9/ca/fc/f9cafc3c68c0eebfcf40ad331cb9931a.jpg')" data-url="https://i.pinimg.com/736x/f9/ca/fc/f9cafc3c68c0eebfcf40ad331cb9931a.jpg"></button>
								<button class="wp-btn w-16 h-12 rounded bg-cover bg-center border-2 border-transparent hover:border-[#dd4814] focus:border-[#dd4814] transition-all" style="background-image: url('https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=600')" data-url="https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=1920"></button>
							</div>
						</div>
						
						<hr class="border-gray-200 dark:border-gray-700">
						<div class="flex justify-between items-center">
							<div>
								<div class="font-bold text-lg"><span class="lang-en">Language</span><span class="lang-vi">Ng√¥n ng·ªØ</span></div>
								<div class="text-sm text-gray-500"><span class="lang-en">System display language</span><span class="lang-vi">Ng√¥n ng·ªØ hi·ªÉn th·ªã h·ªá th·ªëng</span></div>
							</div>
							<select id="lang-select" class="bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white text-sm rounded-lg focus:ring-[#dd4814] focus:border-[#dd4814] block p-2 outline-none">
								<option value="en" selected>English</option>
								<option value="vi">Ti·∫øng Vi·ªát</option>
							</select>
						</div>
					</div>
				</div>

				<div id="win-preview" class="app-window absolute hidden flex-col rounded-lg shadow-[0_30px_60px_rgba(0,0,0,0.6)] border border-gray-300 dark:border-gray-700 bg-white dark:bg-[#1a1a1a] overflow-hidden" style="width: 850px; height: 650px; top: 10%; left: 25%;">
					<div class="window-header h-10 bg-gray-200 dark:bg-[#202124] flex justify-between items-center px-4 select-none cursor-move border-b border-gray-300 dark:border-black">
						<div class="flex items-center gap-2 font-bold text-gray-600 dark:text-gray-300 text-xs">
							<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
							<span>Project Viewer</span>
						</div>
						<div class="flex items-center gap-3">
							<button class="win-btn-minimize w-4 h-4 flex items-center justify-center text-gray-500 hover:text-black dark:text-gray-400 dark:hover:text-white bg-transparent hover:bg-gray-300 dark:hover:bg-gray-600 rounded-full z-50 cursor-pointer"><svg class="w-3 h-3 pointer-events-none" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button>
							<button class="win-btn-maximize w-4 h-4 flex items-center justify-center text-gray-500 hover:text-black dark:text-gray-400 dark:hover:text-white bg-transparent hover:bg-gray-300 dark:hover:bg-gray-600 rounded-full z-50 cursor-pointer"><svg class="w-3 h-3 border border-current rounded-sm pointer-events-none" viewBox="0 0 10 10"></svg></button>
							<button class="win-btn-close w-4 h-4 flex items-center justify-center text-gray-500 hover:text-black dark:text-gray-400 dark:hover:text-white bg-transparent hover:bg-[#E95420] rounded-full z-50 cursor-pointer"><svg class="w-3 h-3 pointer-events-none" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button>
						</div>
					</div>
					<div class="h-10 bg-gray-100 dark:bg-[#35363a] flex items-center px-4 border-b border-gray-300 dark:border-black shadow-sm shrink-0">
						<div class="flex-1 bg-white dark:bg-[#202124] rounded-full h-7 flex items-center px-4 border border-gray-300 dark:border-gray-600 text-sm font-mono text-gray-500 dark:text-gray-400 truncate" id="preview-url">
							system://projects/...
						</div>
					</div>
					<div class="flex-1 overflow-y-auto custom-scrollbar bg-gray-50 dark:bg-[#121212] p-6 flex flex-col items-center">
						<div class="max-w-3xl w-full flex flex-col items-center gap-6 pb-10">
							<h2 id="preview-title" class="text-3xl font-bold text-gray-900 dark:text-white text-center">T√™n D·ª± √Ån</h2>
							
							<div id="preview-tech" class="flex flex-wrap justify-center gap-2">
								</div>

							<div id="preview-images" class="w-full flex flex-col gap-4 items-center">
								</div>

							<div id="preview-links" class="w-full flex flex-col items-center gap-3 my-4">
								</div>

							<div class="w-full text-center">
								<p id="preview-desc-en" class="lang-en text-gray-700 dark:text-gray-300 leading-relaxed text-lg"></p>
								<p id="preview-desc-vi" class="lang-vi text-gray-700 dark:text-gray-300 leading-relaxed text-lg"></p>
							</div>
						</div>
					</div>
				</div>

			</div>

			<div id="fake-cursor" class="fixed z-[99999] w-6 h-6 pointer-events-none opacity-0" style="top: 0; left: 0; transform: translate(50vw, 100vh);">
				<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" fill="#ffffff" stroke="#000000" stroke-width="40" class="drop-shadow-xl"><path d="M759.5 863.6l-133.4-315.9 161.4-56.9c25.4-8.9 33.5-41.9 14.2-61.2L297.6 125.5c-18.4-18.4-49.3-8.8-54.3 16.9L135.5 818.1c-4.4 22.8 17.6 41.5 39 33l181-71.9 133.4 315.9c10 23.7 39.8 30.2 57.6 12.5l194.5-195.8c14.6-14.7 18.2-36.9 8.5-48.2z"/></svg>
			</div>
		</div>
	</div>

	<template id="tpl-help">
		<div class="mt-1 mb-3 animate-fade-in text-gray-200">
			<p class="text-purple-400 font-bold mb-2"><span class="lang-en">Available Commands:</span><span class="lang-vi">C√°c l·ªánh kh·∫£ d·ª•ng:</span></p>
			<div class="grid grid-cols-[100px_1fr] gap-1 pl-2">
				<span class="text-[#729fcf] font-bold">whoami</span><span>: <span class="lang-en">View personal profile</span><span class="lang-vi">Xem th√¥ng tin c√° nh√¢n</span></span>
				<span class="text-[#729fcf] font-bold">skill</span><span>: <span class="lang-en">View tech stack & details</span><span class="lang-vi">Xem k·ªπ nƒÉng & chi ti·∫øt</span></span>
				<span class="text-[#729fcf] font-bold">projects</span><span>: <span class="lang-en">List of works</span><span class="lang-vi">Danh s√°ch d·ª± √°n</span></span>
				<span class="text-[#729fcf] font-bold">contact</span><span>: <span class="lang-en">Contact information</span><span class="lang-vi">Th√¥ng tin li√™n h·ªá</span></span>
				<span class="text-[#729fcf] font-bold">settings</span><span>: <span class="lang-en">Open System Settings</span><span class="lang-vi">M·ªü c√†i ƒë·∫∑t h·ªá th·ªëng</span></span>
				<span class="text-[#729fcf] font-bold">clear</span><span>: <span class="lang-en">Clear terminal screen</span><span class="lang-vi">X√≥a m√†n h√¨nh terminal</span></span>
			</div>
		</div>
	</template>

	<template id="tpl-whoami">
		<div class="mt-1 mb-3 animate-fade-in text-gray-200">
			<h1 class="text-2xl font-bold mb-1 text-white">Nguy·ªÖn Trung Nguy√™n</h1>
			<p class="text-[#E95420] mb-2 font-bold">Software Engineer / Full-stack Developer</p>
			<p class="lang-en">Passionate about building scalable web applications and exploring new technologies.</p>
			<p class="lang-vi">ƒêam m√™ x√¢y d·ª±ng c√°c ·ª©ng d·ª•ng web t·ªëi ∆∞u v√† kh√°m ph√° c√°c c√¥ng ngh·ªá m·ªõi.</p>
		</div>
	</template>

	<template id="tpl-skill">
		<div class="mt-1 mb-3 animate-fade-in text-gray-200">
			<p class="text-[#8ae234] mb-3">‚úî Skills loaded successfully.</p>
			<div class="flex flex-col gap-3 pl-2">
				{skillCategories.map(cat => (
					<div class="flex flex-col sm:flex-row sm:items-start gap-1 sm:gap-4">
						<span class="text-[#729fcf] font-bold w-48 shrink-0">{cat.name}:</span>
						<div class="flex flex-wrap gap-1.5">
							{cat.items.map(item => (
								<span class="px-2 py-0.5 bg-gray-800 text-xs rounded border border-gray-600 text-white shadow-sm">{item}</span>
							))}
						</div>
					</div>
				))}
			</div>
		</div>
	</template>

	<template id="tpl-projects">
		<div class="mt-1 mb-4 animate-fade-in text-gray-200">
			<p class="text-purple-400 font-bold mb-2"><span class="lang-en">My Projects (Click to view):</span><span class="lang-vi">D·ª± √°n c·ªßa t√¥i (B·∫•m ƒë·ªÉ xem):</span></p>
			<div class="flex flex-col gap-2 pl-2">
				{projects.map(p => (
					<div class="project-link flex items-center gap-3 cursor-pointer hover:bg-white/10 p-1.5 rounded w-fit transition-colors group" data-id={p.id}>
						<svg class="w-4 h-4 text-[#729fcf] group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path></svg>
						<span class="text-[#729fcf] font-bold group-hover:underline decoration-dashed">{p.name}</span>
						<span class="text-gray-400 text-sm italic ml-2">- <span class="lang-en">{p.desc.en}</span><span class="lang-vi">{p.desc.vi}</span></span>
					</div>
				))}
			</div>
			<p class="mt-3 text-gray-500 text-xs italic"><span class="lang-en">* Or type 'files' to open graphical file manager.</span><span class="lang-vi">* Ho·∫∑c g√µ 'files' ƒë·ªÉ m·ªü tr√¨nh qu·∫£n l√Ω file ƒë·ªì h·ªça.</span></p>
		</div>
	</template>

	<template id="tpl-contact">
		<div class="mt-1 mb-4 animate-fade-in text-gray-200">
			<p class="text-[#8ae234] mb-3">Network connection established. Feel free to connect with me!</p>
			<div class="flex flex-col gap-2 pl-2">
				<div class="flex items-center gap-3 w-fit group/contact">
					<span class="text-[#729fcf] font-bold w-24">[Phone]</span>
					<a href="tel:0364036518" class="hover:text-[#dd4814] transition-colors underline decoration-dashed">0364036518</a>
					<button class="copy-btn text-gray-500 hover:text-white opacity-0 group-hover/contact:opacity-100 transition-opacity" data-copy="0364036518" title="Copy"><svg class="w-4 h-4 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg></button>
				</div>
				<div class="flex items-center gap-3 w-fit group/contact">
					<span class="text-[#729fcf] font-bold w-24">[Email]</span>
					<a href="mailto:ntnguyen248nd@gmail.com" class="hover:text-[#dd4814] transition-colors underline decoration-dashed">ntnguyen248nd@gmail.com</a>
					<button class="copy-btn text-gray-500 hover:text-white opacity-0 group-hover/contact:opacity-100 transition-opacity" data-copy="ntnguyen248nd@gmail.com" title="Copy"><svg class="w-4 h-4 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg></button>
				</div>
				<div class="flex items-center gap-3 w-fit group/contact">
					<span class="text-[#729fcf] font-bold w-24">[GitHub]</span>
					<a href="https://github.com/TrungNguyen248" target="_blank" class="hover:text-[#dd4814] transition-colors underline decoration-dashed">github.com/TrungNguyen248</a>
					<button class="copy-btn text-gray-500 hover:text-white opacity-0 group-hover/contact:opacity-100 transition-opacity" data-copy="https://github.com/TrungNguyen248" title="Copy"><svg class="w-4 h-4 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg></button>
				</div>
				<div class="flex items-center gap-3 w-fit group/contact">
					<span class="text-[#729fcf] font-bold w-24">[LinkedIn]</span>
					<a href="https://www.linkedin.com/in/ntnguyen248/" target="_blank" class="hover:text-[#dd4814] transition-colors underline decoration-dashed">linkedin.com/in/ntnguyen248</a>
					<button class="copy-btn text-gray-500 hover:text-white opacity-0 group-hover/contact:opacity-100 transition-opacity" data-copy="https://www.linkedin.com/in/ntnguyen248/" title="Copy"><svg class="w-4 h-4 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg></button>
				</div>
			</div>
		</div>
	</template>

	<template id="tpl-error">
		<div class="text-[#ef2929] mt-1 mb-3 animate-fade-in">
			bash: <span class="cmd-name font-bold"></span>: command not found.<br>
			<span class="text-gray-400 text-sm"><span class="lang-en">Type 'help' to see available commands.</span><span class="lang-vi">G√µ 'help' ƒë·ªÉ xem danh s√°ch l·ªánh.</span></span>
		</div>
	</template>

	<script is:inline define:vars={{ projects }}>
		window.portfolioProjects = projects;
	</script>

	<style is:global>
		html:not(.lang-vi) .lang-vi { display: none !important; }
		html.lang-vi .lang-en { display: none !important; }

		.animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
		@keyframes fadeIn { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }
		
		.custom-scrollbar::-webkit-scrollbar { width: 8px; }
		.custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
		.custom-scrollbar::-webkit-scrollbar-thumb { background-color: rgba(150, 150, 150, 0.4); border-radius: 4px; }
		
		.dragging { opacity: 0.95; cursor: grabbing !important; }
		.window-header { cursor: grab; }
		.window-header:active { cursor: grabbing !important; }
	</style>

	<script>
		document.addEventListener('DOMContentLoaded', () => {
			
			// --- 1. BOOT SEQUENCE ---
			setInterval(() => {
				const now = new Date();
				document.getElementById('clock').textContent = now.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }) + ' ' + now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false });
			}, 1000);

			const bootScreen = document.getElementById('boot-screen');
			const desktop = document.getElementById('desktop');
			const fakeCursor = document.getElementById('fake-cursor');
			
			setTimeout(() => {
				bootScreen.classList.add('opacity-0');
				desktop.classList.remove('opacity-0');
				setTimeout(() => {
					bootScreen.style.display = 'none';
					runMouseAnimation(); 
				}, 1500);
			}, 2000);

			function runMouseAnimation() {
				fakeCursor.classList.remove('opacity-0');
				fakeCursor.classList.add('transition-all', 'duration-[1200ms]', 'ease-in-out');
				const btn = document.getElementById('dock-terminal');
				const rect = btn.getBoundingClientRect();
				fakeCursor.style.transform = `translate(${rect.left + rect.width / 2}px, ${rect.top + rect.height / 2}px)`;

				setTimeout(() => {
					fakeCursor.classList.add('scale-75');
					btn.classList.add('scale-90');
					setTimeout(() => {
						fakeCursor.classList.remove('scale-75');
						btn.classList.remove('scale-90');
						fakeCursor.style.transform = `translate(100vw, 100vh)`;
						fakeCursor.classList.add('opacity-0');
						toggleApp('terminal', 'open'); 
					}, 200);
				}, 1200);
			}

			// --- 2. WINDOW MANAGER ---
			let zIndexCounter = 5000; 
			const windowArea = document.getElementById('window-area');
			
			const apps = {
				terminal: { win: document.getElementById('win-terminal'), dockBtn: document.getElementById('dock-terminal'), dot: document.querySelector('#dock-terminal .app-dot'), isOpen: false, isMaximized: false },
				files: { win: document.getElementById('win-files'), dockBtn: document.getElementById('dock-files'), dot: document.querySelector('#dock-files .app-dot'), isOpen: false, isMaximized: false },
				settings: { win: document.getElementById('win-settings'), dockBtn: document.getElementById('dock-settings'), dot: document.querySelector('#dock-settings .app-dot'), isOpen: false, isMaximized: false },
				preview: { win: document.getElementById('win-preview'), dockBtn: null, dot: null, isOpen: false, isMaximized: false }
			};

			function bringToFront(winEl) {
				zIndexCounter++;
				winEl.style.zIndex = zIndexCounter.toString();
			}

			function makeDraggable(winEl) {
				const headerEl = winEl.querySelector('.window-header');
				let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
				
				winEl.onmousedown = () => bringToFront(winEl);
				
				headerEl.onmousedown = (e) => {
					if ((e.target as HTMLElement).tagName.toLowerCase() === 'button' || (e.target as HTMLElement).closest('button')) return; 
					if (winEl.style.width === '100%') return; 
					
					e.preventDefault();
					pos3 = e.clientX;
					pos4 = e.clientY;
					document.onmouseup = closeDragElement;
					document.onmousemove = elementDrag;
					winEl.classList.add('dragging');
					bringToFront(winEl);
				};

				function elementDrag(e) {
					e.preventDefault();
					pos1 = pos3 - e.clientX;
					pos2 = pos4 - e.clientY;
					pos3 = e.clientX;
					pos4 = e.clientY;
					
					let newTop = winEl.offsetTop - pos2;
					let newLeft = winEl.offsetLeft - pos1;
					const maxLeft = windowArea.clientWidth - winEl.clientWidth;
					const maxTop = windowArea.clientHeight - winEl.clientHeight;

					if (newLeft < 0) newLeft = 0;
					if (newTop < 0) newTop = 0;
					if (newLeft > maxLeft) newLeft = maxLeft;
					if (newTop > maxTop) newTop = maxTop;

					winEl.style.top = newTop + "px";
					winEl.style.left = newLeft + "px";
				}
				function closeDragElement() {
					document.onmouseup = null;
					document.onmousemove = null;
					winEl.classList.remove('dragging');
				}
			}

			function toggleApp(appId, action = 'toggle') {
				const app = apps[appId];
				if (!app) return;

				if (action === 'open' || (action === 'toggle' && !app.isOpen)) {
					app.win.classList.remove('hidden');
					app.win.classList.add('flex');
					if(app.dot) app.dot.classList.remove('hidden');
					app.isOpen = true;
					bringToFront(app.win);
					if(appId === 'terminal' && !isOverviewActive) document.getElementById('cmd-input').focus();
				} 
				else if (action === 'close') {
					app.win.classList.add('hidden');
					app.win.classList.remove('flex');
					if(app.dot) app.dot.classList.add('hidden');
					app.isOpen = false;
				}
				else if (action === 'minimize') {
					app.win.classList.add('hidden');
					app.win.classList.remove('flex');
					app.isOpen = false; 
				}
				else if (action === 'toggle' && app.isOpen) {
					if (app.win.style.zIndex == zIndexCounter.toString()) {
						app.win.classList.add('hidden');
						app.win.classList.remove('flex');
						app.isOpen = false;
					} else {
						bringToFront(app.win);
					}
				}
			}

			function toggleMaximize(appId) {
				const app = apps[appId];
				app.isMaximized = !app.isMaximized;
				if (app.isMaximized) {
					app.win.dataset.oldTop = app.win.style.top;
					app.win.dataset.oldLeft = app.win.style.left;
					app.win.dataset.oldWidth = app.win.style.width;
					app.win.dataset.oldHeight = app.win.style.height;
					
					app.win.style.transition = 'all 0.2s';
					app.win.style.top = '0px';
					app.win.style.left = '0px';
					app.win.style.width = '100%';
					app.win.style.height = '100%';
					app.win.style.borderRadius = '0px';
					setTimeout(() => app.win.style.transition = '', 200);
				} else {
					app.win.style.transition = 'all 0.2s';
					app.win.style.top = app.win.dataset.oldTop;
					app.win.style.left = app.win.dataset.oldLeft;
					app.win.style.width = app.win.dataset.oldWidth;
					app.win.style.height = app.win.dataset.oldHeight;
					app.win.style.borderRadius = '0.5rem';
					setTimeout(() => app.win.style.transition = '', 200);
				}
				bringToFront(app.win);
			}

			Object.keys(apps).forEach(appId => {
				const app = apps[appId];
				makeDraggable(app.win);
				if(app.dockBtn) {
					app.dockBtn.addEventListener('click', () => {
						if(isOverviewActive) toggleActivities();
						toggleApp(appId);
					});
				}
				app.win.querySelector('.win-btn-close').addEventListener('click', () => toggleApp(appId, 'close'));
				app.win.querySelector('.win-btn-minimize').addEventListener('click', () => toggleApp(appId, 'minimize'));
				app.win.querySelector('.win-btn-maximize').addEventListener('click', () => toggleMaximize(appId));
			});


			// --- 3. ACTIVITIES OVERVIEW ---
			let isOverviewActive = false;
			const activitiesBackdrop = document.getElementById('activities-backdrop');
			
			function toggleActivities() {
				isOverviewActive = !isOverviewActive;
				const openApps = Object.values(apps).filter(a => a.isOpen && !a.win.classList.contains('hidden'));
				
				if (isOverviewActive) {
					activitiesBackdrop.classList.remove('hidden');
					const total = openApps.length;
					openApps.forEach((app, index) => {
						const win = app.win;
						win.dataset.origTop = win.style.top;
						win.dataset.origLeft = win.style.left;
						win.dataset.origTransform = win.style.transform || '';
						
						win.style.transition = 'all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1)';
						win.style.transform = 'scale(0.65)';
						win.style.top = '10%';
						const offsetPercent = (100 / (total + 1)) * (index + 1);
						win.style.left = `calc(${offsetPercent}% - ${win.clientWidth / 2}px)`;

						let overlay = document.createElement('div');
						overlay.className = 'overview-overlay absolute inset-0 z-[99999] cursor-pointer rounded-lg bg-black/10 hover:bg-transparent transition-colors';
						overlay.onclick = (e) => {
							e.stopPropagation();
							toggleActivities();
							bringToFront(win);
						};
						win.appendChild(overlay);
					});
				} else {
					activitiesBackdrop.classList.add('hidden');
					openApps.forEach((app) => {
						const win = app.win;
						let overlay = win.querySelector('.overview-overlay');
						if (overlay) overlay.remove();
						if (win.dataset.origTop !== undefined) {
							win.style.top = win.dataset.origTop;
							win.style.left = win.dataset.origLeft;
							win.style.transform = win.dataset.origTransform;
							setTimeout(() => win.style.transition = '', 400);
						}
					});
				}
			}
			document.getElementById('btn-activities').addEventListener('click', toggleActivities);
			activitiesBackdrop.addEventListener('click', () => { if(isOverviewActive) toggleActivities(); });


			// --- 4. PREVIEW WINDOW (DYNAMIC PROJECT DETAILS) ---
			function openProjectPreview(id) {
				const p = (window as any).portfolioProjects.find(item => item.id === id);
				if (!p) return;

				document.getElementById('preview-title').textContent = p.name;
				document.getElementById('preview-url').textContent = `system://projects/${p.name}`;
				
				// X√≥a ·∫£nh c≈©, th√™m array ·∫£nh m·ªõi
				const imgContainer = document.getElementById('preview-images');
				imgContainer.innerHTML = '';
				if (p.details && p.details.images) {
					p.details.images.forEach(imgUrl => {
						const imgEl = document.createElement('img');
						imgEl.className = "w-full max-h-[400px] object-cover rounded-lg shadow-lg border border-gray-200 dark:border-gray-800";
						imgEl.src = imgUrl;
						imgContainer.appendChild(imgEl);
					});
				}

				// M√¥ t·∫£ d·∫°ng text
				document.getElementById('preview-desc-en').textContent = p.details.about.en;
				document.getElementById('preview-desc-vi').textContent = p.details.about.vi;

				// C·∫≠p nh·∫≠t Tags
				const techContainer = document.getElementById('preview-tech');
				techContainer.innerHTML = '';
				p.details.tech.forEach(t => {
					const span = document.createElement('span');
					span.className = 'px-3 py-1 bg-[#e0e0e0] dark:bg-[#2d2d2d] text-gray-800 dark:text-gray-200 text-xs font-bold rounded-full border border-gray-300 dark:border-gray-700 shadow-sm';
					span.textContent = t;
					techContainer.appendChild(span);
				});

				// C·∫≠p nh·∫≠t Links v·ªõi n√∫t Copy
				const linkContainer = document.getElementById('preview-links');
				linkContainer.innerHTML = '';
				if(p.details && p.details.links) {
					p.details.links.forEach(l => {
						const div = document.createElement('div');
						div.className = "flex items-center gap-3 bg-white dark:bg-[#2d2d2d] px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm w-full max-w-lg";
						
						div.innerHTML = `
							<span class="font-bold text-[#E95420] w-32 shrink-0">${l.label}:</span>
							<a href="${l.url}" target="_blank" class="flex-1 text-[#729fcf] hover:underline truncate text-sm">${l.url}</a>
							<button class="copy-btn p-1.5 text-gray-500 hover:text-green-500 transition-colors bg-gray-100 dark:bg-[#1a1a1a] rounded" data-copy="${l.url}" title="Copy">
								<svg class="w-4 h-4 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
							</button>
						`;
						linkContainer.appendChild(div);
					});
				}

				toggleApp('preview', 'open');
			}

			// B·∫Øt s·ª± ki·ªán Click cho Copy Button tr√™n TO√ÄN B·ªò document (Terminal Contact + Project Links)
			document.body.addEventListener('click', (e) => {
				const copyBtn = (e.target as HTMLElement).closest('.copy-btn');
				if (copyBtn) {
					const textToCopy = copyBtn.getAttribute('data-copy');
					navigator.clipboard.writeText(textToCopy).then(() => {
						const originalHTML = copyBtn.innerHTML;
						// ƒê·ªïi icon sang checkmark xanh
						copyBtn.innerHTML = `<svg class="w-4 h-4 text-green-500 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>`;
						setTimeout(() => { copyBtn.innerHTML = originalHTML; }, 2000);
					});
					return;
				}

				const link = (e.target as HTMLElement).closest('.project-link');
				if (link) {
					const id = link.getAttribute('data-id');
					openProjectPreview(id);
				}
			});


			// --- 5. TERMINAL LOGIC ---
			const cmdInput = document.getElementById('cmd-input') as HTMLInputElement;
			const historyContainer = document.getElementById('history-container');
			const terminalScroll = document.getElementById('main-terminal-scroll');
			const timelineList = document.getElementById('timeline-list');
			let commandCount = 0;
			let isAnimating = false;

			document.getElementById('terminal-body').addEventListener('click', () => { if(!isOverviewActive) cmdInput.focus(); });

			cmdInput.addEventListener('keydown', (e) => {
				if (e.key === 'Enter' && !isAnimating) {
					const cmd = cmdInput.value.trim().toLowerCase();
					if (cmd) executeCommand(cmd);
					cmdInput.value = '';
				}
			});

			function executeCommand(cmdStr) {
				commandCount++;
				const blockId = `cmd-block-${commandCount}`;
				
				if (cmdStr === 'clear') {
					historyContainer.innerHTML = '';
					timelineList.innerHTML = '';
					return;
				}

				if (cmdStr === 'files') {
					toggleApp('files', 'open');
					return; 
				}
				if (cmdStr === 'settings') {
					toggleApp('settings', 'open');
					return;
				}

				const cmdDiv = document.createElement('div');
				cmdDiv.id = blockId;
				cmdDiv.className = "flex items-center mb-1 font-ubuntu-mono";
				cmdDiv.innerHTML = `<span class="text-[#8ae234] font-bold shrink-0">nguyen@ubuntu</span><span class="text-white shrink-0 mx-1">:</span><span class="text-[#729fcf] font-bold shrink-0">~</span><span class="text-white font-bold mx-1 shrink-0">$</span><span class="text-white ml-2">${cmdStr}</span>`;
				historyContainer.appendChild(cmdDiv);

				const validCommands = ['help', 'whoami', 'skill', 'projects', 'contact'];
				let tplId = `tpl-${cmdStr}`;
				let isError = false;

				if (!validCommands.includes(cmdStr)) { tplId = 'tpl-error'; isError = true; }

				const template = document.getElementById(tplId) as HTMLTemplateElement;
				if (template) {
					const clone = template.content.cloneNode(true);
					if (isError) (clone as HTMLElement).querySelector('.cmd-name').textContent = cmdStr;
					historyContainer.appendChild(clone);
				}

				updateTimeline(cmdStr, blockId, isError);
				setTimeout(() => terminalScroll.scrollTop = terminalScroll.scrollHeight, 10);
			}

			function updateTimeline(cmdName, targetId, isError) {
				const li = document.createElement('li');
				li.className = "relative group cursor-pointer w-full flex items-center justify-end h-6 mt-1";
				const dotColor = isError ? 'bg-[#ef2929]' : 'bg-[#729fcf]';
				li.innerHTML = `<span class="text-[11px] text-gray-400 font-ubuntu-mono mr-3 group-hover:text-white transition-colors">${cmdName}</span><div class="w-2 h-2 rounded-full ${dotColor} absolute right-[-4px] z-10 group-hover:scale-150 transition-transform"></div>`;
				li.addEventListener('click', () => {
					const target = document.getElementById(targetId);
					if (target) terminalScroll.scrollTo({ top: target.offsetTop - terminalScroll.offsetTop, behavior: 'smooth' });
				});
				timelineList.appendChild(li);
			}

			document.getElementById('btn-auto').addEventListener('click', async function() {
				if (isAnimating) return;
				isAnimating = true;
				cmdInput.disabled = true;
				this.classList.add('opacity-50');
				executeCommand('clear');
				
				const commandsToRun = ['whoami', 'skill', 'projects', 'contact'];
				for (const cmd of commandsToRun) {
					await new Promise(resolve => {
						let i = 0; cmdInput.value = '';
						const typing = setInterval(() => {
							cmdInput.value += cmd.charAt(i); i++;
							if (i >= cmd.length) {
								clearInterval(typing);
								setTimeout(() => { executeCommand(cmd); cmdInput.value = ''; resolve(true); }, 200);
							}
						}, 50);
					});
					await new Promise(r => setTimeout(r, 800)); 
				}
				isAnimating = false;
				cmdInput.disabled = false;
				cmdInput.focus();
				this.classList.remove('opacity-50');
			});


			// --- 6. SETTINGS ---
			document.getElementById('btn-power').addEventListener('click', () => window.location.reload());

			const desktopEl = document.getElementById('desktop');
			document.querySelectorAll('.wp-btn').forEach(btn => {
				btn.addEventListener('click', function() {
					const url = this.getAttribute('data-url');
					desktopEl.style.backgroundImage = `url('${url}')`;
				});
			});

			const themeToggle = document.getElementById('theme-toggle');
			const langSelect = document.getElementById('lang-select');
			const topbarLang = document.getElementById('topbar-lang-indicator');
			
			themeToggle.addEventListener('change', (e) => {
				if ((e.target as HTMLInputElement).checked) document.documentElement.classList.add('dark');
				else document.documentElement.classList.remove('dark');
			});

			langSelect.addEventListener('change', (e) => {
				const isVi = (e.target as HTMLSelectElement).value === 'vi';
				if (isVi) {
					document.documentElement.classList.add('lang-vi');
					topbarLang.textContent = 'VI';
				} else {
					document.documentElement.classList.remove('lang-vi');
					topbarLang.textContent = 'EN';
				}
			});
		});
	</script>
</Layout>